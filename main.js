(()=>{"use strict";const e=JSON.parse(localStorage.getItem("PROJECT_LIST"))||[];class t{constructor(e,o){this.id=Date.now().toString(),this.title=e,this.description=o,this.todos=[],this.isActive=t.setActive()}static setActive(){return e.forEach((e=>{e.isActive=!1})),!0}}const o=t,n=class{constructor(e,t){this.id=Date.now().toString(),this.title=e,this.date=t}},c=function(){const t=document.querySelector(".grid-left"),o=document.querySelector(".todos"),c=document.querySelector(".current-title"),i=document.querySelector(".current-description");function d(o){const n=document.createElement("div"),d=document.createElement("p"),l=document.createElement("a"),m=document.createElement("i");c.textContent=o.title,i.textContent=o.description,n.classList.add("project"),o.isActive&&n.classList.add("active"),d.classList.add("project-title"),l.classList.add("btn-trash"),m.className="fa-solid fa-trash-can",n.id=o.id,d.textContent=o.title,n.addEventListener("click",(e=>{"div"!==e.target.tagName.toLowerCase()&&"p"!==e.target.tagName.toLowerCase()||s(n,o)})),l.addEventListener("click",(t=>{"a"!==t.target.tagName.toLowerCase()&&"i"!==t.target.tagName.toLowerCase()||function(t,o){const{id:n}=o;let d;e.forEach(((t,o)=>{t.id===n&&(e.splice(o,1),d=e[o-1])})),a();const r=t.previousElementSibling;d&&r||(c.textContent="",i.textContent="",u(),t.remove()),s(r,d),t.remove()}(n,o)})),l.append(m),n.append(d,l),t.append(n),o.isActive&&o.todos.forEach((e=>{r(e)}))}function a(){localStorage.setItem("PROJECT_LIST",JSON.stringify(e))}function r(t){const c=document.createElement("li"),i=document.createElement("p"),d=document.createElement("h5"),r=document.createElement("i"),s=document.createElement("i");c.classList.add("todo"),r.className="fa-solid fa-pen todo-edit",s.className="fa-solid fa-trash todo-delete",c.id=t.id,i.textContent=t.title,d.textContent=t.date,r.addEventListener("click",(()=>{const t=document.createElement("input"),o=document.createElement("input");t.classList.add("input-edit"),o.classList.add("input-edit"),window.document.addEventListener("keydown",(l=>{if("Enter"===l.key){const l=t.value,u=o.value;if(!l||!u)return;i.textContent=l,d.textContent=u,t.remove(),o.remove(),c.append(i,d,r,s),new n(l,u),e.forEach((e=>{e.isActive&&e.todos.forEach((e=>{e.id===c.id&&(e.title=l,e.date=u)}))})),a()}})),i.remove(),d.remove(),r.remove(),s.remove(),t.value=i.textContent,o.value=d.textContent,c.append(t,o)})),s.addEventListener("click",(()=>{!function(t,o){const{id:n}=o;e.forEach((e=>{e.todos.forEach(((t,o)=>{t.id===n&&e.todos.splice(o,1)}))})),a(),t.remove()}(c,t)})),c.append(i,d,r,s),o.append(c)}function s(e,t){t.isActive||(l(),t.isActive=!0,e.classList.add("active"),function(e){c.textContent=e.title,i.textContent=e.description}(t),u(),t.todos.forEach((e=>{r(e)})))}function l(){const t=document.querySelectorAll(".project");e.forEach((e=>{e.isActive=!1})),t.forEach((e=>{e.classList.remove("active")}))}function u(){document.querySelectorAll(".todo").forEach((e=>{e.remove()}))}return{initialRender:function(){e.forEach((e=>{d(e)}))},renderProject:d,addTodoAndRender:function(t){0!==e.length&&(e.forEach((e=>{e.isActive&&e.todos.push(t)})),a(),r(t))},addProjectAndRender:function(t){e.push(t),a(),d(t)},removeActive:l,cleanTodos:u,switchProject:s}}();c.initialRender(),function(){const e=document.querySelector(".btn-add"),t=document.querySelector(".btn-new"),i=document.querySelector(".modal-project"),d=document.querySelector(".modal-todo"),a=document.querySelectorAll(".btn-cross"),r=document.querySelectorAll(".btn-submit"),s=document.querySelectorAll("form"),l=document.querySelector(".todo-title"),u=document.querySelector(".todo-date"),m=document.querySelector(".input-title"),v=document.querySelector(".input-description");function f(e){"i"===e.target.tagName.toLowerCase()?d.classList.remove("hide"):i.classList.remove("hide")}function E(e){e.preventDefault(),i.classList.add("hide"),d.classList.add("hide")}e.addEventListener("click",f),t.addEventListener("click",f),a.forEach((e=>{e.addEventListener("click",E)})),window.document.addEventListener("click",(e=>{e.target.classList.contains("modal")&&E(e)})),s.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault()}))})),r.forEach((e=>{e.addEventListener("click",(e=>{if(e.target.classList.contains("btn-todo")){const t=l.value,o=u.value;if(!t||!o)return;const i=new n(t,o);c.addTodoAndRender(i),l.value="",u.value="",E(e)}else{const t=m.value,n=v.value;if(!t||!n)return;c.removeActive(),c.cleanTodos();const i=new o(t,n);c.addProjectAndRender(i),m.value="",v.value="",E(e)}}))}))}()})();